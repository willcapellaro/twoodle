{"version":3,"file":"BatchableText.mjs","sources":["../../../../src/scene/text/canvas/BatchableText.ts"],"sourcesContent":["import { BatchableSprite } from '../../sprite/BatchableSprite';\n\nimport type { Renderer } from '../../../rendering/renderers/types';\nimport type { Text } from '../Text';\n\n/** @internal */\nexport class BatchableText extends BatchableSprite\n{\n    private readonly _renderer: Renderer;\n    public currentKey: string;\n\n    constructor(renderer: Renderer)\n    {\n        super();\n\n        // Next step is to make canvasTextSystem a GLOBAL object.\n        // so this is ok for now..\n        this._renderer = renderer;\n\n        renderer.runners.resolutionChange.add(this);\n    }\n\n    public resolutionChange()\n    {\n        const text = this.renderable as Text;\n\n        if (text._autoResolution)\n        {\n            text.onViewUpdate();\n        }\n    }\n\n    public destroy()\n    {\n        const { canvasText } = this._renderer;\n        const refCount = canvasText.getReferenceCount(this.currentKey);\n\n        if (refCount > 0)\n        {\n            canvasText.decreaseReferenceCount(this.currentKey);\n        }\n        else if (this.texture)\n        {\n            canvasText.returnTexture(this.texture);\n        }\n\n        this._renderer.runners.resolutionChange.remove(this);\n        (this._renderer as null) = null;\n    }\n}\n"],"names":[],"mappings":";;;AAMO,MAAM,sBAAsB,eACnC,CAAA;AAAA,EAII,YAAY,QACZ,EAAA;AACI,IAAM,KAAA,EAAA,CAAA;AAIN,IAAA,IAAA,CAAK,SAAY,GAAA,QAAA,CAAA;AAEjB,IAAS,QAAA,CAAA,OAAA,CAAQ,gBAAiB,CAAA,GAAA,CAAI,IAAI,CAAA,CAAA;AAAA,GAC9C;AAAA,EAEO,gBACP,GAAA;AACI,IAAA,MAAM,OAAO,IAAK,CAAA,UAAA,CAAA;AAElB,IAAA,IAAI,KAAK,eACT,EAAA;AACI,MAAA,IAAA,CAAK,YAAa,EAAA,CAAA;AAAA,KACtB;AAAA,GACJ;AAAA,EAEO,OACP,GAAA;AACI,IAAM,MAAA,EAAE,UAAW,EAAA,GAAI,IAAK,CAAA,SAAA,CAAA;AAC5B,IAAA,MAAM,QAAW,GAAA,UAAA,CAAW,iBAAkB,CAAA,IAAA,CAAK,UAAU,CAAA,CAAA;AAE7D,IAAA,IAAI,WAAW,CACf,EAAA;AACI,MAAW,UAAA,CAAA,sBAAA,CAAuB,KAAK,UAAU,CAAA,CAAA;AAAA,KACrD,MAAA,IACS,KAAK,OACd,EAAA;AACI,MAAW,UAAA,CAAA,aAAA,CAAc,KAAK,OAAO,CAAA,CAAA;AAAA,KACzC;AAEA,IAAA,IAAA,CAAK,SAAU,CAAA,OAAA,CAAQ,gBAAiB,CAAA,MAAA,CAAO,IAAI,CAAA,CAAA;AACnD,IAAC,KAAK,SAAqB,GAAA,IAAA,CAAA;AAAA,GAC/B;AACJ;;;;"}